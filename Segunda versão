# Banco de dados
import pandas as pd

def obter_dados_item():
  # Obtem dados do produto
  codigo = input("Código do item: ").strip()
  descricao = input("Descrição do Item: ").strip()
  while True:
    escolha = input("Categoria: Digite 1 para Matéria-Prima ou 2 para Produto acabado:")
    if escolha == "1":
      categoria = "Matéria-Prima"
      break
    elif escolha == "2":
      categoria = "Produto Acabado"
      break
    else:
      print("Entrada inválida. Digite 1 ou 2.")
  unidade = input("Unidade (ex: kg, L, un): ").strip()
  return {"Código": codigo,  "Item": descricao, "Categoria": categoria, "Unidade": unidade}

def adicionar_ao_estoque(estoque_lista, produto):
# Adiciona um produto
  estoque_lista.append(produto)
  print(f"'{produto['Item']}' cadastrado!")

def mostrar_pilha(estoque_lista):
  # Mostra a pilha de itens do último para o primeiro
  if not estoque_lista:
    print("\n--- Pilha vazia ---")
    return
  print("\n--- Pilha ---")
  print(f"{'Código':10} {'Item':20} {'Categoria':20} {'Unidade':10}")
  print("-" * 50)
  for produto in reversed(estoque_lista):    # Para imprimir ao contrário
    print(f"{produto['Código']:10} {produto['Item']:20} {produto['Categoria']:20} {produto['Unidade']:10}")   # Para alinhar a tabela!!

def exibir_tabela_estoque(estoque_lista):
  # Para exibir a tabela (normal)
    """Mostra a lista completa de itens (ordem de cadastro)."""
    print("\n--- Lista completa de itens (ordem de cadastro) ---")
    if not estoque_lista:
        print("Nenhum item cadastrado.")
        return
    print(f"{'Código':10} {'Item':20} {'Categoria':20} {'Unidade':10}")
    print("-" * 50)
    for p in estoque_lista:
        print(f"{p['Código']:10} {p['Item']:20} {p['Categoria']:20} {p['Unidade']:10}")

# Programa principal
estoque = []

inicio = input("Deseja cadastrar um item? (s/n): ").lower().strip()
if inicio != "s":
  print("Nenhum cadastro realizado.")
  exibir_tabela_estoque(estoque) 

# Loop para o cadastro
while True:
  novo_item = obter_dados_item()
  adicionar_ao_estoque(estoque, novo_item)
  continuar = input("Deseja cadastrar outro item? (s/n): ").lower().strip()
  if continuar != "s":
    break
print("\n--- Lista completa em forma de Pilha ---")
mostrar_pilha(estoque)

# Para exportar os dados
if estoque:
    print("\n--- Opções de exportação ---")
    print("Digite 1 para exportar como Excel.")
    print("Digite 2 para exportar como CSV.")
    print("Digite 3 para não exportar.")
    exportar = input("\nDeseja exportar os dados? ").lower().strip()

    if exportar == "1":
        # Cria um banco e salva em Excel
        df = pd.DataFrame(estoque)
        df.to_excel("estoque.xlsx", index=False)
        print("\nDados exportados para 'estoque.xlsx' com sucesso!")

    elif exportar == "2":
        # Cria um banco de dados e salva em CSV
        df = pd.DataFrame(estoque)
        df.to_csv("estoque.csv", index=False, encoding="utf-8-sig")
        print("\nDados exportados para 'estoque.csv' com sucesso!")

    else:
        print("\nExportação não realizada.")
else:
    print("\nNenhum item cadastrado. Nada a exportar.")
